(function(e){function t(t){for(var n,o,c=t[0],s=t[1],l=t[2],f=0,d=[];f<c.length;f++)o=c[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,c=1;c<r.length;c++){var s=r[c];0!==a[s]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={app:0},i=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/circuit-patch-converter/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"3b24":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-app-bar",{attrs:{app:"",dark:""}},[r("div",{staticClass:"d-flex align-center"},[e._v("CIRCUIT PATCH CONVERTER")]),r("v-spacer"),r("v-btn",{attrs:{href:"/novation/2021/04/27/circuit-patch-converter.html",target:"_blank",text:""}},[r("span",{staticClass:"mr-2"},[e._v("How it works")]),r("v-icon",[e._v("mdi-open-in-new")])],1)],1),r("v-main",[r("v-col",{staticClass:"mb-5 mt-10",attrs:{cols:"12"}},[r("v-row",{staticClass:"text-h6 text-center mb-8",attrs:{justify:"center"}},[e._v(" A small utility for fast patch file conversion between Novation Circuit and Circuit Tracks format. "),r("br"),e._v(" Works in both directions. ")]),r("v-row",{attrs:{justify:"center"}},[r("FilesSelector",{attrs:{label:"Drop your .syx files here, or open from disk",accept:".syx",multiple:!0}})],1)],1),r("v-col",{staticClass:"mb-5",attrs:{cols:"12"}},[r("v-row",{attrs:{justify:"center"}},[r("v-btn",{attrs:{depressed:"",color:"primary",large:"",disabled:!e.filesNotEmpty||e.downloadInProcess},on:{click:e.convertAndDownloadFiles}},[e.downloadInProcess?r("v-progress-circular",{staticClass:"mr-1",attrs:{size:18,width:3,color:"green",indeterminate:""}}):r("v-icon",{attrs:{left:"",dark:""}},[e._v("mdi-content-save")]),e._v(" Convert and save ")],1)],1)],1)],1)],1)},i=[],o=r("5530"),c=r("2f62"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"dropzone",staticClass:"dropzone",on:{dragover:function(e){e.preventDefault()},dragleave:e.dragleave,dragenter:e.dragenter,drop:e.drop}},[e.disableLabel?e._e():e._t("default",[r("h1",[e._v(e._s(e.label||"Upload Box"))])]),r("v-btn",{on:{click:function(t){return e.$refs.filebtn.click()}}},[r("v-icon",{attrs:{left:"",dark:""}},[e._v("mdi-harddisk")]),e._v(" Select files ")],1),e.disableHint?e._e():r("p",[e._v(" *You can select Single Patches and Patch Packs (not Circuit Packs)."),r("br"),e._v(" All files will be saved as separate patches. Works better in Chrome. ")]),r("div",{staticClass:"input-container mt-5"},e._l(e.files,(function(t){return r("FileCard",{key:t.name,attrs:{fileInfo:t},on:{remove:function(r){return e.remove(t)}}})})),1),r("input",{ref:"filebtn",staticClass:"filebtn",attrs:{type:"file",multiple:e.multiple,accept:e.validatedAccept&&e.validatedAccept.extensions.concat(e.validatedAccept.mimetypes).join(",")},on:{input:e.upload}})],2)},l=[],u=(r("d81d"),r("ac1f"),r("5319"),r("4d63"),r("25f0"),r("4de4"),r("1276"),r("466d"),r("13d5"),r("b0c0"),r("159b"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{staticClass:"mb-5",attrs:{shaped:"",elevation:"2",color:e.fileInfo.metaData&&e.fileInfo.metaData.converted?"teal darken-4":""}},[r("v-card-title",[e.fileInfo.metaData?r("v-icon",{staticClass:"mr-1"},[e._v(e._s(e.fileInfo.metaData&&"Patch Pack"===e.fileInfo.metaData.fileType?"mdi-file-multiple":"mdi-file"))]):e._e(),e._v(" "+e._s(e.fileInfo.file.name)+" "),r("v-spacer"),r("v-btn",{attrs:{icon:""},on:{click:function(t){return e.remove()}}},[r("v-icon",[e._v("mdi-close")])],1)],1),e.fileInfo.metaData&&!e.fileInfo.metaData.error?r("v-card-subtitle",{staticClass:"pb-3 pl-5"},[e._v(" "+e._s(e.fileInfo.metaData.product+" - "+e.fileInfo.metaData.fileType)+" "),r("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,a=t.attrs;return[r("v-icon",e._g(e._b({},"v-icon",a,!1),n),[e._v(" mdi-chevron-right ")])]}}],null,!1,3874895316)},[r("span",[e._v("Will be converted to")])]),e._v(" "+e._s("Circuit"===e.fileInfo.metaData.product?"Circuit Tracks":"Circuit")+" ")],1):e._e(),r("v-card-text",[e.fileInfo.metaData&&!e.fileInfo.metaData.error?r("ul",{staticClass:"pl-5"},e._l(e.fileInfo.metaData.patches,(function(t,n){return r("li",{key:n+t.name,staticClass:"mb-4",style:"Patch Pack"===e.fileInfo.metaData.fileType?"list-style-type: decimal":""},[t.error?r("v-alert",{attrs:{dense:"",border:"left",type:"error",color:"red lighten-2",dark:""}},[e._v(" "+e._s(t.error)+" ")]):r("h3",[e._v(e._s(t.name))]),t.error?e._e():r("v-chip",{staticClass:"mt-2 mr-2",attrs:{color:"deep-purple lighten-2",outlined:""}},[e._v(" Genre: "),r("strong",[e._v(e._s(t.genre))])]),t.error?e._e():r("v-chip",{staticClass:"mt-2",attrs:{dense:"",color:"indigo lighten-2",outlined:""}},[e._v(" Category: "),r("strong",[e._v(e._s(t.category))])])],1)})),0):e._e(),e.fileInfo.metaData&&e.fileInfo.metaData.error?r("v-alert",{attrs:{border:"left",type:"error",color:"red lighten-2",dark:""}},[e._v(" "+e._s(e.fileInfo.metaData.error)+" ")]):e._e()],1)],1)}),f=[],d={props:{fileInfo:{type:Object,required:!0}},methods:Object(o["a"])({remove:function(){this.$emit("remove",null)}},Object(c["d"])(["removeFiles"]))},p=d,v=r("2877"),m=r("6544"),h=r.n(m),b=r("0798"),y=r("8336"),g=r("b0af"),C=r("99d9"),k=r("cc20"),_=r("132d"),w=r("2fa4"),x=r("3a2f"),D=Object(v["a"])(p,u,f,!1,null,null,null),O=D.exports;h()(D,{VAlert:b["a"],VBtn:y["a"],VCard:g["a"],VCardSubtitle:C["a"],VCardText:C["b"],VCardTitle:C["c"],VChip:k["a"],VIcon:_["a"],VSpacer:w["a"],VTooltip:x["a"]});var j={components:{FileCard:O},props:{label:{type:String,required:!1},accept:{type:String,required:!1},multiple:{type:Boolean,required:!1},disableLabel:{type:Boolean,required:!1},disableHint:{type:Boolean,required:!1}},data:function(){return{hoverCounter:0,hoveringContent:null,matchAnything:/.*/}},computed:Object(o["a"])({filebtn:{cache:!1,get:function(){return this.$refs.filebtn}},dropzone:{cache:!1,get:function(){return this.$refs.dropzone}},validTypes:function(){return this.validatedAccept?{extensions:this.validatedAccept.extensions.map((function(e){return e.replace(/(\W)/g,"\\$1")})).map((function(e){return new RegExp("".concat(e,"$"),"i")})),mimetypes:this.validatedAccept.mimetypes.map((function(e){return e.replace(/([-+/])/g,"\\$1")})).map((function(e){return e.replace(/\*/g,"(?:[A-Za-z0-9\\-\\+]*)*")})).map((function(e){return new RegExp("^".concat(e,"$"))}))}:{extensions:[this.matchAnything],mimetypes:[this.matchAnything]}},validatedAccept:function(){return this.accept?{extensions:this.accept.split(",").filter((function(e){return e.match(/^\.(?!.*\/)/)})),mimetypes:this.accept.split(",").filter((function(e){return e.match(/^(?:(?:[A-Za-z0-9\-+]*)|\*)\/(?:(?:[A-Za-z0-9\-+.]*)|\*)$/)}))}:null}},Object(c["e"])(["files"])),methods:Object(o["a"])({upload:function(){for(var e,t=this,r=null!==(e=this.filebtn.files)&&void 0!==e?e:[],n=function(e){t.multiple||t.clearFiles();var n=t.validTypes.extensions.reduce((function(t,n){return t||!!r[e].name.match(n)}),!1)||t.validTypes.mimetypes.reduce((function(t,n){return t||!!r[e].type.match(n)}),!1);n&&t.addFile(r[e])},a=0;a<r.length;a++)n(a);this.filebtn.value=""},dragenter:function(e){this.hoveringContent=e.dataTransfer.items,this.hoverCounter++},dragleave:function(e){this.hoverCounter--},drop:function(e){var t=this;if(e.preventDefault(),this.hoverCounter=0,e.dataTransfer.items){for(var r=[],n=0;n<e.dataTransfer.items.length;n++)if("file"===e.dataTransfer.items[n].kind){var a=function(){if(e.dataTransfer.items[n].webkitGetAsEntry){var a=e.dataTransfer.items[n].webkitGetAsEntry();if(a.isDirectory)return r.push(a.name),"continue"}var i=e.dataTransfer.items[n].getAsFile();if(!i)return"continue";var o=t.validTypes.extensions.reduce((function(e,t){return e||!!i.name.match(t)}),!1)||t.validTypes.mimetypes.reduce((function(e,t){return e||!!i.type.match(t)}),!1);if(!o)return r.push(i),"continue";t.multiple?t.files.map((function(e){return e.file})).filter((function(e){return e.name===i.name})).forEach((function(e){return t.removeFiles({start:t.files.indexOf(e),deleteCount:1})})):t.clearFiles(),t.addFile(i)}();if("continue"===a)continue}r.length&&this.$emit("rejectedFiles",r)}},remove:function(e){var t=this.files;this.removeFiles({start:t.indexOf(e),deleteCount:1}),this.$emit("update",null)}},Object(c["d"])(["removeFiles","addFile"])),watch:{multiple:function(e){e||this.removeFiles({start:0,deleteCount:this.files.length-1})},hoveringContent:function(e){var t=this;if(e)if(this.accept&&this.accept.length&&0===this.validTypes.extensions.length){for(var r=!1,n=function(n){if(t.validTypes.mimetypes.reduce((function(t,r){return t||!!e[n].type.match(r)})))return r=!0,"break"},a=0;a<e.length;a++){var i=n(a);if("break"===i)break}r&&(this.dropzone.style.backgroundColor="rgba(0, 0, 0, 0.25)")}else{for(var o=!1,c=0;c<e.length;c++)if("file"===e[c].kind){o=!0;break}o&&(this.dropzone.style.backgroundColor="rgba(0, 0, 0, 0.25)")}else this.dropzone.style.backgroundColor=""},hoverCounter:function(e){0===e&&(this.hoveringContent=null)}}},T=j,I=(r("b44b"),Object(v["a"])(T,s,l,!1,null,"61c3c631",null)),P=I.exports;h()(I,{VBtn:y["a"],VIcon:_["a"]});var F={name:"App",components:{FilesSelector:P},watch:{files:function(){this.processFiles()}},computed:Object(o["a"])(Object(o["a"])({},Object(c["e"])(["files","downloadInProcess"])),Object(c["c"])(["filesNotEmpty"])),methods:Object(o["a"])({},Object(c["b"])(["processFiles","convertAndDownloadFiles"]))},A=F,S=r("7496"),V=r("40dc"),E=r("62ad"),$=r("f6c4"),z=r("490a"),R=r("0fd9"),B=Object(v["a"])(A,a,i,!1,null,null,null),N=B.exports;h()(B,{VApp:S["a"],VAppBar:V["a"],VBtn:y["a"],VCol:E["a"],VIcon:_["a"],VMain:$["a"],VProgressCircular:z["a"],VRow:R["a"],VSpacer:w["a"]});var M=r("f309");n["a"].use(M["a"]);var H=new M["a"]({theme:{dark:!0}}),U=r("1da1"),L=r("b85c"),q=(r("96cf"),r("dca8"),r("a434"),r("d3b7"),r("5cc6"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("72f7"),r("498a"),r("fb6a"),r("3ca3"),r("ddb0"),r("2b3d"),r("a15b"),/[\/\?<>\\:\*\|":]/g),G=/[\x00-\x1f\x80-\x9f]/g,W=/^\.+$/,J=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i;function Z(e,t){var r=e.replace(q,t).replace(G,t).replace(W,t).replace(J,t);return r.split("").splice(0,255).join("")}var K=function(e,t){var r=t&&t.replacement||"",n=Z(e,r);return""===r?n:Z(n,"")};n["a"].use(c["a"]);var X=Object.freeze(["None","Arp","Bass","Bell","Classic","Drum","Keyboard","Lead","Movement","Pad","Poly","SFX","Strings","User","Voc/Tune"]),Y=Object.freeze(["None","Classic","DnB Breaks","House","Industrial","Jazz","RnB/HipHop","Rock/Pop","Techno","Dubstep"]),Q=new c["a"].Store({state:{files:[],downloadInProcess:!1},getters:{filesNotEmpty:function(e){return e.files.length>0}},mutations:{clearFiles:function(e){e.files.splice(0,e.files.length)},removeFiles:function(e,t){t&&void 0!==t.start&&void 0!==t.deleteCount?e.files.splice(t.start,t.deleteCount):console.error('Invalid arguments for "removeFiles" store mutation',t)},addFile:function(e,t){t?e.files.push({file:t,metaData:null}):console.error('Invalid argument for "addFile" store mutation',t)},setMetaData:function(e,t){if(t&&t.fileInfo&&t.metaData){var r=e.files.indexOf(t.fileInfo);-1!=r&&(e.files[r].metaData=t.metaData)}else console.error('Invalid arguments for "setMetaData" store mutation',t)},setDownloadProcess:function(e,t){e.downloadInProcess=t}},actions:{processFiles:function(e){var t,r=Object(L["a"])(e.state.files);try{var n=function(){var r=t.value;if(r.metaData)return"continue";e.dispatch("processFileHeader",r.file).then((function(t){console.log("File processed:",r.file.name,"Meta:",t),e.commit("setMetaData",{fileInfo:r,metaData:t})}))};for(r.s();!(t=r.n()).done;)n()}catch(a){r.e(a)}finally{r.f()}},processFileHeader:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,i,o,c,s,l,u,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={product:"",fileType:"",patches:[],converted:!1,error:null},a=null,e.prev=2,e.next=5,r.arrayBuffer();case 5:i=e.sent,a=new Uint8Array(i),e.next=13;break;case 9:return e.prev=9,e.t0=e["catch"](2),n.error=new Error("Error loading file content. "+e.t0),e.abrupt("return",n);case 13:o=function(e){var t={product:"",name:"",category:"",genre:"",data:e,error:null};if(240!=e[0]||247!=e[e.length-1])return t.error=new Error("Not a SysEx file format"),t;if(0!=e[1]||32!=e[2]||41!=e[3])return t.error=new Error("Not Novation SysEx file format"),t;if(1==e[4]&&96==e[5])t.product="Circuit";else{if(1!=e[4]||100!=e[5])return t.error=new Error("Not an Original Circuit or Circuit Tracks patch"),t;t.product="Circuit Tracks"}var r=e.subarray(9,25).reduce((function(e,t){return e+String.fromCharCode(t)}),"");return t.name=r.trim(),e[25]>X.length-1?console.warn("Category is not found"):t.category=X[e[25]],e[26]>Y.length-1?console.warn("Genre is not found"):t.genre=Y[e[26]],t},e.t1=r.size,e.next=350===e.t1?17:22400===e.t1?23:27;break;case 17:return c=o(a),n.fileType="Single Patch",n.product=c.product,n.error=c.error,n.patches.push(c),e.abrupt("break",29);case 23:for(n.fileType="Patch Pack",s=0;s<64;s++)l=350*s,u=a.slice(l,l+350),f=o(u),n.patches.push(f);return n.patches.length>0&&(n.product=n.patches[0].product),e.abrupt("break",29);case 27:return n.error=new Error("File type is not supported"),e.abrupt("return",n);case 29:return e.abrupt("return",n);case 30:case"end":return e.stop()}}),e,null,[[2,9]])})));function t(t,r){return e.apply(this,arguments)}return t}(),convertAndDownloadFiles:function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,c,s,l,u,f,d,p,v;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=function(e,t){var r=document.createElement("a");r.href=e,r.download=t,document.body.appendChild(r),r.style.display="none",r.click(),r.remove()},n=function(e,t,n){var a=new Blob([e],{type:n}),i=window.URL.createObjectURL(a);r(i,t),setTimeout((function(){return window.URL.revokeObjectURL(i)}),1e3)},a=function(e){return new Promise((function(t,r){setTimeout(t,e||1e3)}))},t.commit("setDownloadProcess",!0),i=0,o=Object(L["a"])(t.state.files),e.prev=6,o.s();case 8:if((c=o.n()).done){e.next=43;break}if(s=c.value,!s.metaData.error&&!s.metaData.converted){e.next=12;break}return e.abrupt("continue",41);case 12:l=Object(L["a"])(s.metaData.patches),e.prev=13,l.s();case 15:if((u=l.n()).done){e.next=32;break}if(f=u.value,!f.error){e.next=19;break}return e.abrupt("continue",30);case 19:if(d=f.data.slice(),d[5]=96===d[5]?100:96,p="Circuit"===f.product?"CircuitTracks":"Circuit",v=K(f.name+"."+p+".SinglePatch.syx"),console.log("Patch converted:",v),n(d,v,"application/octet-stream"),!(++i>=10)){e.next=30;break}return console.log("Pause for 1 second"),e.next=29,a(1e3);case 29:i=0;case 30:e.next=15;break;case 32:e.next=37;break;case 34:e.prev=34,e.t0=e["catch"](13),l.e(e.t0);case 37:return e.prev=37,l.f(),e.finish(37);case 40:s.metaData.converted=!0;case 41:e.next=8;break;case 43:e.next=48;break;case 45:e.prev=45,e.t1=e["catch"](6),o.e(e.t1);case 48:return e.prev=48,o.f(),e.finish(48);case 51:t.commit("setDownloadProcess",!1);case 52:case"end":return e.stop()}}),e,null,[[6,45,48,51],[13,34,37,40]])})));function t(t){return e.apply(this,arguments)}return t}()}});n["a"].config.productionTip=!1,new n["a"]({vuetify:H,store:Q,render:function(e){return e(N)}}).$mount("#app")},b44b:function(e,t,r){"use strict";r("3b24")}});
//# sourceMappingURL=app.3c07f1f6.js.map